<!DOCTYPE html>
<html lang="en">

    <head>

        <title>PANIC Engine</title>

		<meta charset="UTF-8">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="icon" type="image/png" href="../logo.png"/>

        <style>

            html, body {

                width: 100%;
                height: 100%;

                margin: 0;

				overflow: hidden;

            }

			#PANIC {

				width: 100%;
				height: 100%;

			}

			#PANIC-Rendering {

				width: 100%;
				height: 100%;

			}

        </style>

    </head>

    <body>

		<script src="../build/panic.js"></script>

        <script>

			PANIC.Debug.enable();

			PANIC.Debug.Access.enable();

			let Fish = null;

			let Run = 0;

			try {

				// Add 'await' if seeking complete loading prior to rendering

				PANIC.Loaders.Entity.load( "./presets/entities/minecraft/minecraft.json" );
				PANIC.Loaders.Entity.load( "./presets/entities/minecraft/slim.json" );

				PANIC.Loaders.Entity.load( "./presets/entities/player/player.json" );

				PANIC.Loaders.Entity.load( "./presets/entities/debug/debug.json" );

				PANIC.Loaders.Entity.load( "./presets/entities/fish/fish.json" ).then( ( template ) => {

					Fish = PANIC.EntityRegistry.spawnEntity( template.id )

					PANIC.Updater.add( "updateFish", Fish, "update" );

					// ???
					PANIC.Keyboard.on( "W", () => {
                        Fish.position.x -= 0.0625 * Math.sin( Fish.rotation.y );
                        Fish.position.z -= 0.0625 * Math.cos( Fish.rotation.y );
                    } );
					PANIC.Keyboard.on( "S", () => {
                        Fish.position.x += 0.0625 * Math.sin( Fish.rotation.y );
                        Fish.position.z += 0.0625 * Math.cos( Fish.rotation.y );
                    } );

                    PANIC.Keyboard.on( "A", () => { Fish.rotation.y += 0.1; } );
					PANIC.Keyboard.on( "D", () => { Fish.rotation.y -= 0.1; } );

					// 60 fps
					// if( PANIC.Keyboard.isKeyDown("W") ) { Fish.position.y += 0.01; }

				} );

				PANIC.Debug.Grid.toggle();
				PANIC.Debug.Grid.scale = 16;
				PANIC.Debug.Grid.subdivisions = 16;
				PANIC.Debug.Grid.color = 0x888888;

				PANIC.Debug.Axes.toggle();

				PANIC.Debug.Compass.toggle();

				let Loop = function( time=0 ) {

				    PANIC.Updater.update();

				    PANIC.Renderer.render( PANIC.Scene, PANIC.Camera );

				    requestAnimationFrame( Loop );

				}

				requestAnimationFrame( Loop );

			}

			catch( error ) {

				PANIC.Debug.error( error );

			}

        </script>

    </body>

</html>
